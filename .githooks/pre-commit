#!/bin/sh
echo 'ğŸ†ã‚³ãƒŸãƒƒãƒˆå‰ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³é–‹å§‹ï¼'
fileList=$(git diff --diff-filter=d --cached --name-only)

backendFiles=$(echo "$fileList" | grep -E '^backend/.*\.php$')
if [ ${#backendFiles} -gt 0 ]; then
  echo 'backendã®PHPãƒ•ã‚¡ã‚¤ãƒ«ãŒå¤‰æ›´ã•ã‚Œã¦ã„ã¾ã™ã€‚Linterã‚’å®Ÿè¡Œã—ã¾ã™ã€‚'
  make f-b
  make c-b
  # ã‚¨ãƒ©ãƒ¼ãŒã‚ã‚Œã°ã€ã‚³ãƒŸãƒƒãƒˆã•ã›ãªã„
  if [ $? -gt 0 ]; then
    exit 1
  fi
  # ã‚¨ãƒ©ãƒ¼ãŒãªã‘ã‚Œã°ã€LinterãŒå¤‰æ›´ã—ãŸå·®åˆ†ã‚’å–ã‚Šè¾¼ã‚“ã§ã‚³ãƒŸãƒƒãƒˆ
  git add ${backendFiles[@]}
fi

frontendFiles=$(echo "$fileList" | grep -E '^frontend/')
if [ ${#frontendFiles} -gt 0 ]; then
  echo 'frontendã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒå¤‰æ›´ã•ã‚Œã¦ã„ã¾ã™ã€‚Linterã‚’å®Ÿè¡Œã—ã¾ã™ã€‚'
  make f-f
  make c-f
  # ã‚¨ãƒ©ãƒ¼ãŒã‚ã‚Œã°ã€ã‚³ãƒŸãƒƒãƒˆã•ã›ãªã„
  if [ $? -gt 0 ]; then
    exit 1
  fi
  # ã‚¨ãƒ©ãƒ¼ãŒãªã‘ã‚Œã°ã€LinterãŒå¤‰æ›´ã—ãŸå·®åˆ†ã‚’å–ã‚Šè¾¼ã‚“ã§ã‚³ãƒŸãƒƒãƒˆ
  git add ${frontendFiles[@]}
fi

nlpFiles=$(echo "$fileList" | grep -E '^frontend/')
if [ ${#nlpFiles} -gt 0 ]; then
  echo 'nlpã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒå¤‰æ›´ã•ã‚Œã¦ã„ã¾ã™ã€‚Linterã‚’å®Ÿè¡Œã—ã¾ã™ã€‚'
  make f-n
  make c-n
  # ã‚¨ãƒ©ãƒ¼ãŒã‚ã‚Œã°ã€ã‚³ãƒŸãƒƒãƒˆã•ã›ãªã„
  if [ $? -gt 0 ]; then
    exit 1
  fi
  # ã‚¨ãƒ©ãƒ¼ãŒãªã‘ã‚Œã°ã€LinterãŒå¤‰æ›´ã—ãŸå·®åˆ†ã‚’å–ã‚Šè¾¼ã‚“ã§ã‚³ãƒŸãƒƒãƒˆ
  git add ${nlpFiles[@]}
fi
